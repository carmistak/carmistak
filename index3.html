<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Coupon Storefront</title>
<style>
    body { font-family: Arial, sans-serif; background: #f4f6fa; margin: 0; }
    h1 { text-align: center; margin: 32px 0 24px 0; font-size: 2.4rem; }
    form.product-grid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr; /* Changed to 3 columns */
        gap: 25px 15px; /* Adjusted gap for 3 columns */
        max-width: 1200px;
        margin: 0 auto 40px auto;
        background: none;
    }
    .product-card {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        padding: 18px 20px 10px 20px;
        gap: 6px;
    }
    .product-card img {
        width: 145px;
        height: 130px;
        object-fit: contain;
        border-radius: 7px;
        background: #f9f9f9;
        border: 1px solid #eee;
        margin-bottom: 10px;
    }
    .product-info { flex: 1; width: 100%; }
    .product-title { font-size: 1.22rem; font-weight: bold; margin-bottom: 6px; }
    .product-savings { font-size: 1.06rem; margin-bottom: 4px; color: #04724d; }
    .product-expiry { font-size: 1.01rem; margin-bottom: 8px; }
    .product-meta { font-size: 0.99rem; margin-bottom: 3px; color: #333; }
    .product-price { font-size: 1.08rem; font-weight: bold; margin-bottom: 0; }
    .quantity-section {
        display: flex;
        align-items: center;
        gap: 6px;
        margin-top: 5px;
        width: 100%;
    }
    .quantity-section label { font-weight: bold; }
    .quantity-section input[type="number"] {
        width: 38px;
        padding: 2px 3px;
        font-size: 1.10rem;
        text-align: right;
    }
    .paypal-btn {
        display: block;
        width: 340px;
        margin: 36px auto 36px auto;
        padding: 14px 0;
        font-size: 1.28rem;
        background: #1570ef;
        color: #fff;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 1px 8px rgba(21,112,239,0.09);
        transition: background 0.18s;
        text-align: center;
    }
    .paypal-btn:hover { background: #1160c1; }
    @media (max-width: 1100px) {
        form.product-grid { grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 700px) {
        form.product-grid { grid-template-columns: 1fr; }
    }
    body, .product-card, .product-info {
        -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;
    }
    body { -webkit-touch-callout: none; }
</style>
<script>document.addEventListener('contextmenu', e => e.preventDefault());</script>
</head>
<body>
<h1>Coupon Storefront</h1>
<form class="product-grid" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" id="product-form">
    <!-- Products will be dynamically inserted here -->
</form>
<button type="submit" class="paypal-btn" form="none" id="paypal-button">Proceed to PayPal</button>

<script>
// Product data from the Excel file
const products = [
{name: "TRESemme", savings_statement: "Save up to $8.00 OFF any ONE (1) TRESemme  product.", expiration_date: "46203", SKU: "C487", price: "2.00"},
{name: "Seventh Generation ", savings_statement: "Save up to $6.00 OFF any ONE (1) Seventh Generation product", expiration_date: "46203", SKU: "C486", price: "2.00"},
{name: "SeaPak ", savings_statement: "Save up to $10.00 OFF any ONE (1) SeaPak  product.", expiration_date: "46203", SKU: "C485", price: "2.00"},
{name: "KETTLE BRAND ", savings_statement: "Save up to $6.00 OFF any ONE (1) KETTLE BRAND  product.", expiration_date: "46203", SKU: "C484", price: "2.00"},
{name: "HELLMANN ", savings_statement: "Save up to $8.00 OFF any ONE (1) HELLMANN'S  product.", expiration_date: "46203", SKU: "C483", price: "2.00"},
{name: "ARM & HAMMER Cat Litter", savings_statement: "Save up to $6.00 OFF any ONE (1) ARM & HAMMER Cat Litter product.", expiration_date: "46203", SKU: "C482", price: "2.00"},
{name: "GOGO SQUEEZ ", savings_statement: "Save up to $5.00 OFF any ONE (1) GOGO SQUEEZ  product.", expiration_date: "46203", SKU: "C481", price: "2.00"},
{name: "organicgirl ", savings_statement: "Save up to $7.00 OFF any ONE (1) organicgirl product.", expiration_date: "46173", SKU: "C480", price: "2.00"},
{name: "Nestle Nesquik ", savings_statement: "Save up to $6.00 OFF any ONE (1) Nestle Nesquik product.", expiration_date: "46173", SKU: "C479", price: "2.00"},
{name: "Glad Trash Bags ", savings_statement: "Save up to $6.00 OFF any ONE (1) Glad Trash Bags product.", expiration_date: "46173", SKU: "C478", price: "2.00"},
{name: "2000 FLUSHES ", savings_statement: "Save up to $6.00 OFF any ONE (1) 2000 FLUSHES product.", expiration_date: "46173", SKU: "C477", price: "2.00"},
{name: "Armor All ", savings_statement: "Save up to $8.00 OFF any ONE (1) Armor All product.", expiration_date: "46173", SKU: "C476", price: "2.00"},
{name: "CELESTIAL SEASONINGS", savings_statement: "Save up to $6.00 OFF any ONE (1) CELESTIAL SEASONINGS product.", expiration_date: "46173", SKU: "C475", price: "2.00"},
{name: "Domino ", savings_statement: "Save up to $7.00 OFF any ONE (1) Domino product.", expiration_date: "46173", SKU: "C474", price: "2.00"},
{name: "Velveeta ", savings_statement: "Save up to $8.00 OFF any ONE (1) Velveeta product.", expiration_date: "46173", SKU: "C473", price: "2.00"},
{name: "BURT'S BEES ", savings_statement: "Save up to $9.00 OFF any ONE (1) BURT'S BEES product.", expiration_date: "46173", SKU: "C472", price: "2.00"},
{name: "Colgate ", savings_statement: "Save up to $6.00 OFF any ONE (1) Colgate product.", expiration_date: "46173", SKU: "C471", price: "2.00"},
{name: "Organic Valley ", savings_statement: "Save up to $8.00 OFF any ONE (1) Organic Valley product.", expiration_date: "46173", SKU: "C470", price: "2.00"},
{name: "Pledge ", savings_statement: "Save up to $6.00 OFF any ONE (1) pledge product.", expiration_date: "46173", SKU: "C469", price: "2.00"},
{name: "Amy", savings_statement: "Save up to $9.00 OFF any ONE (1) Amy's product.", expiration_date: "46173", SKU: "C468", price: "2.00"},
{name: "BUBBA Burger ", savings_statement: "Save up to $7.00 OFF any ONE (1) BUBBA burger product.", expiration_date: "46173", SKU: "C467", price: "2.00"},
{name: "TAMPAX ", savings_statement: "Save up to $9.00 OFF any ONE (1) TAMPAX product.", expiration_date: "46173", SKU: "C466", price: "2.00"},
{name: "LUIGI", savings_statement: "Save up to $6.00 OFF any ONE (1) LUIGI'S REAL ITALIAN ICE product.", expiration_date: "46173", SKU: "C465", price: "2.00"},
{name: "IAMS ", savings_statement: "Save up to $6.00 OFF any ONE (1) IAMS product.", expiration_date: "46173", SKU: "C464", price: "2.00"},
{name: "GATORADE ", savings_statement: "Save up to $9.00 OFF any ONE (1) GATORADE product or multi-pack.", expiration_date: "46173", SKU: "C463", price: "2.00"},
{name: "Annie", savings_statement: "Save up to $9.00 OFF any ONE (1) Annie's product.", expiration_date: "46173", SKU: "C462", price: "2.00"},
{name: "APPLEGATE", savings_statement: "Save up to $8.00 OFF any ONE (1) APPLEGATE product.", expiration_date: "46173", SKU: "C461", price: "2.00"},
{name: "Dreft", savings_statement: "Save up to $6.00 OFF any ONE (1) dreft product.", expiration_date: "46173", SKU: "C460", price: "2.00"},
{name: "Ziploc Brand ", savings_statement: "Save up to $7.00 OFF any ONE (1) Ziploc Brand product.", expiration_date: "46173", SKU: "C459", price: "2.00"},
{name: "PANTENE PRO-V ", savings_statement: "Save up to $9.00 OFF any ONE (1) PANTENE PRO-V product.", expiration_date: "46173", SKU: "C458", price: "2.00"},
{name: "BEN & JERRY", savings_statement: "Save up to $7.00 OFF any ONE (1) BEN & JERRY'S product.", expiration_date: "46173", SKU: "C457", price: "2.00"},
{name: "DEL MONTE ", savings_statement: "Save up to $6.00 OFF any ONE (1) DEL MONTE product.", expiration_date: "46173", SKU: "C456", price: "2.00"},
{name: "HEINZ ", savings_statement: "Save up to $8.00 OFF any ONE (1) HEINZ product.", expiration_date: "46173", SKU: "C455", price: "2.00"},
{name: "Hormel Foods ", savings_statement: "Save up to $6.00 OFF any ONE (1) Hormel Foods product.", expiration_date: "46173", SKU: "C454", price: "2.00"},
{name: "OBERTO ", savings_statement: "Save up to $9.00 OFF any ONE (1) OBERTO product.", expiration_date: "46173", SKU: "C453", price: "2.00"},
{name: "TYSON ", savings_statement: "Save up to $6.00 OFF any ONE (1) TYSON product.", expiration_date: "46173", SKU: "C452", price: "2.00"},
{name: "Tide ", savings_statement: "Save up to $6.00 OFF any ONE (1) Tide product.", expiration_date: "46173", SKU: "C451", price: "2.00"},
{name: "Schick Hydro ", savings_statement: "Save up to $6.00 OFF any ONE (1) Schick Hydro Razor or Refill product.", expiration_date: "46173", SKU: "C450", price: "2.00"},
{name: "CURLY", savings_statement: "Save up to $9.00 OFF any ONE (1) CURLY'S product.", expiration_date: "46173", SKU: "C449", price: "2.00"},
{name: "Ore Ida Potato ", savings_statement: "Save up to $7.00 OFF any ONE (1) Ore Ida Potato product.", expiration_date: "46173", SKU: "C448", price: "2.00"},
{name: "Community Coffee", savings_statement: "Save up to $9.00 OFF any ONE (1) Community Coffee product.", expiration_date: "46142", SKU: "C427", price: "2.00"},
{name: "ban", savings_statement: "Save up to $7.00 OFF any ONE (1) ban product.", expiration_date: "46142", SKU: "C426", price: "2.00"},
{name: "Coca Cola", savings_statement: "Save up to $7.00 OFF any ONE (1) Coca Cola beverages product.", expiration_date: "12/31/2025", SKU: "C425", price: "2.00"},
{name: "SPOT SHOT", savings_statement: "Save up to $7.00 OFF any ONE (1) SPOT SHOT product.", expiration_date: "46142", SKU: "C424", price: "2.00"},
{name: "Silk", savings_statement: "Save up to $7.00 OFF any ONE (1) Silk product.", expiration_date: "46142", SKU: "C423", price: "2.00"},
{name: "CLOROX", savings_statement: "Save up to $8.00 OFF any ONE (1) CLOROX product.", expiration_date: "46142", SKU: "C422", price: "2.00"},
{name: "Jimmy Dean", savings_statement: "Save up to $9.00 OFF any ONE (1) Jimmy Dean product.", expiration_date: "46142", SKU: "C421", price: "2.00"},
{name: "NATURESWEET", savings_statement: "Save up to $7.00 OFF any ONE (1) NATURESWEET Tomatoes product.", expiration_date: "46142", SKU: "C420", price: "2.00"},
{name: "Ocean Spray", savings_statement: "Save up to $8.00 OFF any ONE (1) Ocean Spray product.", expiration_date: "46142", SKU: "C419", price: "2.00"},
{name: "PEARLS", savings_statement: "Save up to $9.00 OFF any ONE (1) PEARLS product.", expiration_date: "46142", SKU: "C418", price: "2.00"},
{name: "Deer Park", savings_statement: "Save up to $7.00 OFF any ONE (1) Deer Park Brand Natural Spring Water Multi-Pack product.", expiration_date: "46112", SKU: "C417", price: "2.00"},
{name: "LISTERINE", savings_statement: "Save up to $12.00 OFF any ONE (1) LISTERINE product.", expiration_date: "46112", SKU: "C416", price: "2.00"},
{name: "NESTLE BRAND", savings_statement: "Save up to $7.00 OFF any ONE (1) NESTLE BRAND product.", expiration_date: "46142", SKU: "C415", price: "2.00"},
{name: "Simply Beverages", savings_statement: "Save up to $6.00 OFF any ONE (1) Simply Beverages product.", expiration_date: "46112", SKU: "C414", price: "2.00"},
{name: "Speed Stick", savings_statement: "Save up to $7.00 OFF any ONE (1) Speed Stick product.", expiration_date: "46112", SKU: "C413", price: "2.00"},
];

// Function to format the expiration date as MM/DD/YYYY
function formatExpirationDate(dateStr) {
    // Check if date is already in MM/DD/YYYY format
    if (dateStr.includes('/')) {
        return dateStr;
    }
    
    // Parse ISO date format
    try {
        const date = new Date(dateStr);
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const day = date.getDate().toString().padStart(2, '0');
        const year = date.getFullYear();
        return `${month}/${day}/${year}`;
    } catch (e) {
        return dateStr; // Return original if parsing fails
    }
}

// Function to generate product cards
function generateProductCards() {
    const form = document.getElementById('product-form');
    
    products.forEach(product => {
        const card = document.createElement('div');
        card.className = 'product-card';
        
        card.innerHTML = `
            <img src="images/${product.SKU}.png" alt="${product.name}" 
                 onerror="this.onerror=null; this.src='https://via.placeholder.com/145x130?text=${product.name}'; this.style.background='#f0f0f0';">
            <div class="product-info">
                <div class="product-title">${product.name}</div>
                <div class="product-savings">${product.savings_statement}</div>
                <div class="product-expiry">Expires ${formatExpirationDate(product.expiration_date)}</div>
                <div class="product-meta">SKU: ${product.SKU}</div>
                <div class="product-price">$${product.price}</div>
            </div>
            <div class="quantity-section">
                <label for="qty_${product.SKU}">Qty:</label>
                <input type="number" id="qty_${product.SKU}" name="quantity_${product.SKU}" min="0" max="99" value="0">
            </div>
        `;
        
        form.appendChild(card);
    });
}

// Function to set up PayPal button handler
function setupPayPalButton() {
    document.getElementById('paypal-button').addEventListener('click', function() {
        var form = document.createElement('form');
        form.method = 'POST';
        form.action = 'https://www.paypal.com/cgi-bin/webscr';
        form.target = '_blank';
        form.innerHTML = ''
            + '<input type="hidden" name="business" value="carmenistak@gmail.com">'
            + '<input type="hidden" name="cmd" value="_cart">'
            + '<input type="hidden" name="upload" value="1">';
        
        var idx = 1;
        
        // Add selected products to PayPal form
        products.forEach(product => {
            const qtyElement = document.getElementById(`qty_${product.SKU}`);
            const qty = qtyElement ? parseInt(qtyElement.value) : 0;
            
            if (qty > 0) {
                form.innerHTML += `<input type="hidden" name="item_name_${idx}" value="${product.name}">`;
                form.innerHTML += `<input type="hidden" name="item_number_${idx}" value="${product.SKU}">`;
                form.innerHTML += `<input type="hidden" name="amount_${idx}" value="${product.price}">`;
                form.innerHTML += `<input type="hidden" name="quantity_${idx}" value="${qty}">`;
                idx++;
            }
        });
        
        if (idx === 1) {
            alert('Please select at least one product.');
            return false;
        }
        
        document.body.appendChild(form);
        form.submit();
        document.body.removeChild(form);
        return false;
    });
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    generateProductCards();
    setupPayPalButton();
});
</script>
</body>
</html>
